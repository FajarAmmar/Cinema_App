import{Component as t,createElement as e,createRef as r}from"react";var s,o={exports:{}};
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/s=o,function(){var t={}.hasOwnProperty;function e(){for(var r=[],s=0;s<arguments.length;s++){var o=arguments[s];if(o){var i=typeof o;if("string"===i||"number"===i)r.push(o);else if(Array.isArray(o)){if(o.length){var n=e.apply(null,o);n&&r.push(n)}}else if("object"===i)if(o.toString===Object.prototype.toString)for(var a in o)t.call(o,a)&&o[a]&&r.push(a);else r.push(o.toString())}}return r.join(" ")}s.exports?(e.default=e,s.exports=e):window.classNames=e}();var i=o.exports;class n extends t{render(){return e("div",{className:i(this.props.className,"size-box"),tabIndex:this.props.tabIndex,style:{...this.setDimensions(),...this.props.style}},e("div",{className:i("size-box-inner",this.props.classNameInner)},this.props.children))}setDimensions(){const{widthUnit:t,width:e,heightUnit:r,height:s,heightAspectRatio:o}=this.props,i={};switch(i.width="".concat(e,"percentage"===t?"%":"px"),r){case"pixels":i.paddingTop=s;break;case"percentageOfWidth":const r=s/100*e;i.paddingTop="percentage"===t?"".concat(r,"%"):r;break;case"percentageOfParent":i.paddingTop=0,i.height="".concat(s,"%");break;case"aspectRatio":let n=0;switch(o){case"oneByOne":n=1;break;case"fourByThree":n=3/4;break;case"threeByTwo":n=2/3;break;case"sixteenByNine":n=9/16;break;case"TwentyOneByNine":n=9/21}i.paddingTop="pixels"===t?e*n:"".concat(e*n,"%")}return i}}const a=t=>/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/g.test(t)?t:"";class l extends t{constructor(){super(...arguments),this.handleAttributes=this.getUrlAttributes.bind(this)}render(){return e("iframe",{className:"widget-video-player-iframe",src:this.generateUrl(this.props.url),frameBorder:"0",allow:"autoplay; fullscreen",allowFullScreen:!0})}generateUrl(t){const e=this.handleAttributes();try{if(t.includes("dailymotion.com/embed"))return"".concat(t).concat(e);const r=t.split("/");if(r.length>0){const t=r[r.length-1];if(t)return"https://www.dailymotion.com/embed/video/".concat(t).concat(e)}}catch(e){return t}return t}getUrlAttributes(){let t="?sharing-enable=false";return t+="&autoplay="+(this.props.autoPlay?"true":"false"),t+="&mute="+(this.props.muted?"true":"false"),t+="&controls="+(this.props.showControls?"true":"false"),t}static canPlay(t){return!!t&&!!a(t)&&t.indexOf("dailymotion.com")>-1}}class p extends t{constructor(){super(...arguments),this.videoElement=r(),this.errorElement=r(),this.handleOnSuccess=this.handleSuccess.bind(this),this.handleOnError=this.handleError.bind(this)}render(){return e("div",{className:i("widget-video-player-html5-container",{"widget-video-player-show-controls":this.props.showControls})},this.props.preview?e("svg",{className:"widget-video-player-preview-play-button",width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e("path",{d:"M0 24C0 10.7452 10.7452 0 24 0C37.2548 0 48 10.7452 48 24C48 37.2548 37.2548 48 24 48C10.7452 48 0 37.2548 0 24Z",fill:"#373737"}),e("path",{d:"M16 12V36L34.8571 24L16 12Z",fill:"white"})):e("div",{className:"video-error-label-html5",ref:this.errorElement},"The video failed to load :("),e("video",{className:"widget-video-player-html5",controls:this.props.showControls,autoPlay:this.props.autoPlay,muted:this.props.muted,loop:this.props.loop,poster:this.props.poster,ref:this.videoElement,height:this.props.aspectRatio?void 0:"100%",preload:this.props.poster?"metadata":"auto"},this.props.preview?null:e("source",{src:this.props.url,type:"video/mp4",onError:this.handleOnError,onLoad:this.handleOnSuccess})))}handleError(){this.errorElement&&this.errorElement.current&&(this.errorElement.current.classList.add("hasError"),this.videoElement&&this.videoElement.current&&(this.videoElement.current.controls=!1))}handleSuccess(){this.errorElement&&this.errorElement.current&&(this.errorElement.current.classList.remove("hasError"),this.videoElement&&this.videoElement.current&&(this.videoElement.current.controls=this.props.showControls))}}class h extends t{constructor(){super(...arguments),this.handleAttributes=this.getUrlAttributes.bind(this)}render(){return e("iframe",{className:"widget-video-player-iframe",src:this.generateUrl(this.props.url),frameBorder:"0",allow:"autoplay; fullscreen",allowFullScreen:!0})}generateUrl(t){const e=this.handleAttributes();try{if(t.includes("player.vimeo.com"))return"".concat(t).concat(e);const r=t.split("/");if(r.length>0){const t=r[r.length-1];if(Number(t)>0&&isFinite(Number(t)))return"https://player.vimeo.com/video/".concat(t).concat(e)}}catch(e){return t}return t}getUrlAttributes(){let t="?dnt=1";return t+="&autoplay="+(this.props.autoPlay?"1":"0"),t+="&muted="+(this.props.muted?"1":"0"),t+="&loop="+(this.props.loop?"1":"0"),t}static canPlay(t){return!!t&&!!a(t)&&t.indexOf("vimeo.com")>-1}}class c extends t{constructor(){super(...arguments),this.handleAttributes=this.getUrlAttributes.bind(this)}render(){return e("iframe",{className:"widget-video-player-iframe",src:this.generateUrl(this.props.url),frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}generateUrl(t){const e=this.handleAttributes();try{if(t.includes("youtube.com/embed/"))return"".concat(t).concat(e);if(t.includes("youtu.be/")||t.includes("youtube.com/v/")){const r=t.split("/");if(r.length>0){const t=r[r.length-1];return"https://www.youtube.com/embed/".concat(t).concat(e)}}if(t.includes("youtube.com/watch?v=")){const r=t.split("watch?v=");if(r.length>0){const t=r[r.length-1];return"https://www.youtube.com/embed/".concat(t).concat(e)}}}catch(e){return t}return t}getUrlAttributes(){let t="?modestbranding=1&rel=0";return t+="&autoplay="+(this.props.autoPlay?"1":"0"),t+="&controls="+(this.props.showControls?"1":"0"),t+="&muted="+(this.props.muted?"1":"0"),t+="&loop="+(this.props.loop?"1":"0"),t}static canPlay(t){return!!t&&!!a(t)&&(t.indexOf("youtube.com")>-1||t.indexOf("youtu.be")>-1)}}class d extends t{constructor(){super(...arguments),this.handleHtml5PlayerRender=this.renderHtml5Player.bind(this),this.handleYoutubePlayerRender=this.renderYoutubePlayer.bind(this),this.handleVimeoPlayerRender=this.renderVimeoPlayer.bind(this),this.handleDailymotionPlayerRender=this.renderDailymotionPlayer.bind(this)}render(){const t=this.props.url||"";return c.canPlay(t)?this.handleYoutubePlayerRender(t):h.canPlay(t)?this.handleVimeoPlayerRender(t):l.canPlay(t)?this.handleDailymotionPlayerRender(t):this.handleHtml5PlayerRender(t)}renderHtml5Player(t){return e(p,{showControls:this.props.showControls,autoPlay:this.props.autoStart,muted:this.props.muted,loop:this.props.loop,poster:this.props.poster,url:t,aspectRatio:this.props.aspectRatio,preview:this.props.preview})}renderYoutubePlayer(t){return e(c,{url:t,showControls:this.props.showControls,autoPlay:this.props.autoStart,muted:this.props.muted,loop:this.props.loop,aspectRatio:this.props.aspectRatio})}renderVimeoPlayer(t){return e(h,{url:t,autoPlay:this.props.autoStart,muted:this.props.muted,loop:this.props.loop,aspectRatio:this.props.aspectRatio})}renderDailymotionPlayer(t){return e(l,{url:t,autoPlay:this.props.autoStart,muted:this.props.muted,showControls:this.props.showControls,aspectRatio:this.props.aspectRatio})}}class u extends t{render(){var t,r,s,o;const a="expression"===this.props.type,l=a?null===(t=this.props.urlExpression)||void 0===t?void 0:t.value:null===(r=this.props.videoUrl)||void 0===r?void 0:r.value,p=a?null===(s=this.props.posterExpression)||void 0===s?void 0:s.value:null===(o=this.props.posterUrl)||void 0===o?void 0:o.value,h=p?"".concat(l,"-").concat(p):l;return e(n,{className:i("widget-video-player widget-video-player-container",this.props.class),style:this.props.style,widthUnit:this.props.widthUnit,width:this.props.width,heightUnit:this.props.heightUnit,height:this.props.height,heightAspectRatio:this.props.heightAspectRatio,tabIndex:this.props.tabIndex},e(d,{key:h,url:l,poster:p,autoStart:this.props.autoStart,showControls:this.props.showControls,loop:this.props.loop,muted:this.props.muted,aspectRatio:"aspectRatio"===this.props.heightUnit,preview:!1}))}}export{u as default};
